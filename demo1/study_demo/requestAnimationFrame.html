<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title></title>
	</head>
	<body>
		<div id="test" style="width:1px height:17px;background:#0f0;">0%</div>
		<input type="button" id="run" value="重新开始">
		<script>
			window.requestAnimationFrame=window.requestAnimationFrame||window.mozRequestAnimationFrame||
				window.webkitRequestAnimationFrame||window.msRequestAnimationFrame;
			var start = null,
				ele=document.getElementById("test"),
				showFalse = false,
				progress = 0;
			function step(timestamp){
				
				progress+=1;
				ele.style.width = progress + "%";
				ele.innerHTML = progress + "%";
				console.log("王长贵"+progress);
				if(progress < 100){
					requestAnimationFrame(step);
				}
			}
			requestAnimationFrame(step);
			document.getElementById("run").addEventListener("click",function(){
				ele.style.width = "1px";
				progress = 0;
				if(showFalse){
					return ;
				}
				showFalse = true;
				requestAnimationFrame(()=>{
					showFalse=false;
					step();
				});
			},false);
		</script>
	</body>
</html>
